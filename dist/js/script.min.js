var usersDataTemplate=e=>`
  <tr>
    <td>${e.name}</td>
    <td>${e.age}</td>
    <td>${e.phone}</td>
    <td>${e.company}</td>
    <td>${e.country}</td>
    <td>
      <button class="edit-btn" data-id="${e.id}"><i class="fas fa-pencil-alt"></i></button>
      <button class="delete-btn" data-id="${e.id}"><i class="fa-solid fa-trash"></i></button>
    </td>
  </tr>`,fetchRecords=()=>{$.ajax({url:"includes/formdata.php",method:"GET",dataType:"json",success:e=>{$(".user-records-body").html(e.data.map(usersDataTemplate).join(""))},error:()=>showToast("Error fetching records","error")})},showToast=(e,r)=>{Toastify({text:e,duration:3e3,gravity:"top",position:"right",backgroundColor:"success"===r?"#4CAF50":"#FF5733"}).showToast()};document.URL.includes("admin.php")&&fetchRecords(),$(".users-registration-form").on("submit",function(r){r.preventDefault();var e,t=new FormData(this);t.get("id")?(e=Object.fromEntries(t.entries()),$.ajax({url:"includes/formdata.php",method:"PATCH",data:JSON.stringify(e),contentType:"application/json",dataType:"json",success:e=>{showToast(e.message,"success"),r.target.reset(),fetchRecords()},error:()=>showToast("Error updating record","error")})):$.ajax({url:"includes/formdata.php",method:"POST",data:t,processData:!1,contentType:!1,dataType:"json",success:e=>{showToast(e.message,"success"),r.target.reset(),fetchRecords()},error:()=>showToast("Error adding record","error")})}),$(".user-records-body").on("click",".edit-btn",function(){var e=$(this).data("id");$.ajax({url:"includes/formdata.php",method:"GET",dataType:"json",data:{action:"get_single",id:e},success:r=>{Object.keys(r.data).forEach(e=>{$(`.users-registration-form [name='${e}']`).val(r.data[e])})},error:()=>showToast("Error fetching record","error")})}),$(".user-records-body").on("click",".delete-btn",e=>{var r=$(e.currentTarget).data("id"),t=$(e.currentTarget).closest("tr");$.ajax({url:"includes/formdata.php",method:"DELETE",data:JSON.stringify({id:r}),contentType:"application/json",dataType:"json",success:e=>{showToast(e.message,"success"),t.remove()},error:()=>showToast("Error deleting record","error")})}),$(".login-form").on("submit",e=>{e.preventDefault();e=$(e.currentTarget).serialize();$.ajax({url:"includes/login.php",method:"POST",data:e,dataType:"json",success:e=>{e.success?window.location.href="admin.php":showToast(e.message,"error")}})}),$(".register-form").on("submit",e=>{e.preventDefault();e=$(e.currentTarget).serialize();$.ajax({url:"register.php",method:"POST",data:e,dataType:"json",success:e=>{showToast(e.message,e.success?"success":"error"),e.success&&$(".register-form")[0].reset()},error:()=>{showToast("Something went wrong. Try again.","error")}})});