var usersDataTemplate=e=>`
  <tr>
    <td>${e.name}</td>
    <td>${e.age}</td>
    <td>${e.phone}</td>
    <td>${e.company}</td>
    <td>${e.country}</td>
    <td>
      <button class="edit-btn" data-id="${e.id}"><i class="fas fa-pencil-alt"></i></button>
      <button class="delete-btn" data-id="${e.id}"><i class="fa-solid fa-trash"></i></button>
    </td>
  </tr>`,fetchRecords=()=>{$.ajax({url:"includes/formdata.php",method:"GET",dataType:"json",success:e=>{$(".user-records-body").html(e.data.map(usersDataTemplate).join(""))},error:()=>showToast("Error fetching records","error")})},showToast=(e,t)=>{Toastify({text:e,duration:3e3,gravity:"top",position:"right",backgroundColor:"success"===t?"#4CAF50":"#FF5733"}).showToast()};document.URL.includes("index.php")&&fetchRecords(),$(".users-registration-form").on("submit",function(t){t.preventDefault();var e,s=new FormData(this);s.get("id")?(e=Object.fromEntries(s.entries()),$.ajax({url:"includes/formdata.php",method:"PATCH",data:JSON.stringify(e),contentType:"application/json",dataType:"json",success:e=>{showToast(e.message,"success"),t.target.reset(),fetchRecords()},error:()=>showToast("Error updating record","error")})):$.ajax({url:"includes/formdata.php",method:"POST",data:s,processData:!1,contentType:!1,dataType:"json",success:e=>{showToast(e.message,"success"),t.target.reset(),fetchRecords()},error:()=>showToast("Error adding record","error")})}),$(".user-records-body").on("click",".edit-btn",function(){var e=$(this).data("id");$.ajax({url:"includes/formdata.php",method:"GET",dataType:"json",data:{action:"get_single",id:e},success:t=>{Object.keys(t.data).forEach(e=>{$(`.users-registration-form [name='${e}']`).val(t.data[e])})},error:()=>showToast("Error fetching record","error")})}),$(".user-records-body").on("click",".delete-btn",e=>{var t=$(e.currentTarget).data("id"),s=$(e.currentTarget).closest("tr");$.ajax({url:"includes/formdata.php",method:"DELETE",data:JSON.stringify({id:t}),contentType:"application/json",dataType:"json",success:e=>{showToast(e.message,"success"),s.remove()},error:()=>showToast("Error deleting record","error")})}),$(".login-form").on("submit",e=>{e.preventDefault();e=$(e.currentTarget).serialize();$.ajax({url:"includes/login.php",method:"POST",data:e,dataType:"json",success:e=>{e.success?(showToast(e.message,"success"),setTimeout(()=>{window.location.href="index.php"},2e3)):showToast(e.message,"error")},error:()=>showToast("Server error, please try again.","error")})}),$(".logout-btn").on("click",()=>{showToast("Logging Out Successfully","success"),setTimeout(()=>{window.location.href="includes/logout.php"},2e3)}),$(".login-again-btn").on("click",()=>{window.location.href="../admin.php"});